[gd_scene load_steps=12 format=3 uid="uid://yuy0svp0u2xk"]

[ext_resource type="Script" path="res://game.gd" id="1_3ui0v"]
[ext_resource type="PackedScene" uid="uid://730ren3udciw" path="res://worm.tscn" id="1_5dp4w"]
[ext_resource type="Script" path="res://spawner.gd" id="2_8uugw"]
[ext_resource type="Script" path="res://player.gd" id="2_ggsq6"]
[ext_resource type="Script" path="res://dots.gd" id="2_nvo7r"]
[ext_resource type="Script" path="res://turn_progress_bar.gd" id="4_1dbbi"]
[ext_resource type="PackedScene" uid="uid://dpoeijkdc2ec5" path="res://action_button.tscn" id="6_aol81"]

[sub_resource type="NavigationPolygon" id="NavigationPolygon_sdu3m"]
vertices = PackedVector2Array(989, 528, 1790, 56, 1845, 993, 977, 573, 977, 483, 863, 64, 943, 449, 898, 437, 47, 995, 55, 63, 853, 449, 819, 483, 807, 528, 819, 573, 853, 607, 898, 619, 943, 607)
polygons = Array[PackedInt32Array]([PackedInt32Array(0, 1, 2, 3), PackedInt32Array(1, 0, 4), PackedInt32Array(5, 1, 4, 6), PackedInt32Array(5, 6, 7), PackedInt32Array(8, 9, 5, 10, 11), PackedInt32Array(5, 7, 10), PackedInt32Array(8, 11, 12), PackedInt32Array(8, 12, 13), PackedInt32Array(8, 13, 14), PackedInt32Array(2, 8, 14, 15), PackedInt32Array(2, 15, 16), PackedInt32Array(2, 16, 3)])
outlines = Array[PackedVector2Array]([PackedVector2Array(46, 53, 37, 1006, 1856, 1003, 1800, 46, 863, 54)])
source_geometry_group_name = &"navigation_polygon_source_group"

[sub_resource type="CircleShape2D" id="CircleShape2D_fvqsw"]
radius = 80.98

[sub_resource type="CircleShape2D" id="CircleShape2D_7hbjk"]
radius = 23.0217

[sub_resource type="CircleShape2D" id="CircleShape2D_vi6u8"]

[node name="Game" type="Node2D" node_paths=PackedStringArray("turn_timer", "end_turn_button")]
script = ExtResource("1_3ui0v")
turn_timer = NodePath("EnemyTurnTimer")
end_turn_button = NodePath("CanvasLayer/Control/EndTurnButton")

[node name="Spawner" type="Node2D" parent="."]
script = ExtResource("2_8uugw")
spawn_scene = ExtResource("1_5dp4w")

[node name="SpawnTimer" type="Timer" parent="Spawner"]
wait_time = 10.0
autostart = true

[node name="EnemyTurnTimer" type="Timer" parent="."]
one_shot = true

[node name="NavigationRegion2D" type="NavigationRegion2D" parent="."]
navigation_polygon = SubResource("NavigationPolygon_sdu3m")

[node name="StaticBody2D" type="StaticBody2D" parent="NavigationRegion2D"]

[node name="CollisionShape2D" type="CollisionShape2D" parent="NavigationRegion2D/StaticBody2D"]
position = Vector2(898, 528)
shape = SubResource("CircleShape2D_fvqsw")

[node name="ColorRect" type="ColorRect" parent="."]
visible = false
offset_right = 1935.0
offset_bottom = 1082.0
color = Color(0.647059, 0.588235, 0.360784, 1)
metadata/_edit_lock_ = true

[node name="Player" type="CharacterBody2D" parent="." node_paths=PackedStringArray("agent", "action_debug_label", "explosion_area", "explosion_shape") groups=["player"]]
position = Vector2(1420, 334)
script = ExtResource("2_ggsq6")
agent = NodePath("NavigationAgent2D")
action_debug_label = NodePath("Label")
explosion_area = NodePath("ExplosionArea")
explosion_shape = NodePath("ExplosionArea/CollisionShape2D")
metadata/_edit_group_ = true

[node name="ColorRect" type="ColorRect" parent="Player"]
offset_left = -12.0
offset_top = -13.0
offset_right = 18.0
offset_bottom = 18.0

[node name="CollisionShape2D" type="CollisionShape2D" parent="Player"]
shape = SubResource("CircleShape2D_7hbjk")

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="Player"]
avoidance_enabled = true

[node name="Label" type="Label" parent="Player"]
offset_left = -16.0
offset_top = -55.0
offset_right = 24.0
offset_bottom = -32.0

[node name="ExplosionArea" type="Area2D" parent="Player"]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Player/ExplosionArea"]
shape = SubResource("CircleShape2D_vi6u8")

[node name="Worm" parent="." instance=ExtResource("1_5dp4w")]
position = Vector2(399, 183)

[node name="Worm2" parent="." node_paths=PackedStringArray("agent") instance=ExtResource("1_5dp4w")]
position = Vector2(211, 231)
agent = NodePath("../Worm/NavigationAgent2D")

[node name="DrawDots" type="Node2D" parent="."]
position = Vector2(961, 1214)
script = ExtResource("2_nvo7r")
metadata/_edit_lock_ = true

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Control" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="ProgressRow" type="HBoxContainer" parent="CanvasLayer/Control"]
layout_mode = 0
offset_left = 28.0
offset_top = 19.0
offset_right = 328.0
offset_bottom = 59.0

[node name="ProgressBar" type="ProgressBar" parent="CanvasLayer/Control/ProgressRow"]
custom_minimum_size = Vector2(300, 0)
layout_mode = 2
script = ExtResource("4_1dbbi")

[node name="HBoxContainer" type="HBoxContainer" parent="CanvasLayer/Control"]
layout_mode = 0
offset_left = 37.0
offset_top = 1001.0
offset_right = 77.0
offset_bottom = 1041.0

[node name="MoveButton" parent="CanvasLayer/Control/HBoxContainer" instance=ExtResource("6_aol81")]
layout_mode = 2

[node name="Attack" parent="CanvasLayer/Control/HBoxContainer" instance=ExtResource("6_aol81")]
layout_mode = 2
text = "Attack"
action = "ATTACK"

[node name="ExplodeButton" parent="CanvasLayer/Control/HBoxContainer" instance=ExtResource("6_aol81")]
layout_mode = 2
text = "Explode"
action = "EXPLODE"

[node name="EndTurnButton" type="Button" parent="CanvasLayer/Control"]
layout_mode = 0
offset_left = 1788.0
offset_top = 1000.0
offset_right = 1796.0
offset_bottom = 1008.0
text = "END TURN"

[connection signal="timeout" from="Spawner/SpawnTimer" to="Spawner" method="_on_spawn_timer_timeout"]
[connection signal="timeout" from="EnemyTurnTimer" to="." method="_on_enemy_turn_timer_timeout"]
[connection signal="pressed" from="CanvasLayer/Control/EndTurnButton" to="." method="_on_end_turn_button_pressed"]
